<!DOCTYPE html>

<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta name="keywords" content="开心小游戏,开心小游戏大全,在线小游戏,单人游戏,单机游戏,双人对战,双人游戏,红包游戏,赚钱小游戏,2019红包,赚钱,好玩游戏,传奇游戏" />
		<meta name="description" content="开心小游戏大全收录国内外单人游戏,单人游戏大全,单人小游戏闯关,单人冒险小游戏,单人小游戏大全无敌版,单人闯关小游戏大全,网络游戏大全,单机游戏大全,连连看游戏大全,益智游戏大全,转圈游戏,红包游戏,邀请朋友们一起边玩边赚钱!" />
		<link rel="stylesheet" href="css/popUps.css" />
		<title>开心网开心小游戏</title>

		<script type="text/javascript" src="js/jquery-1.12.4.min.js" ></script>
		<script type="text/javascript" src="js/lib.js?ver=131"></script>
		<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.4.0.js" ></script>
		<script type="text/javascript" src="https://res2.wx.qq.com/open/js/jweixin-1.4.0.js" ></script>
		
		<style>
			
			html, body
			{
				margin: 0rem;
				width: 100%;
				height: 100%;
			}
			
			
			
			iframe{
				width:1px;
				min-width: 100%;
				*width:100%;
				height: 1px;
				min-height: 100%;
				*height:100%;
			}
			
			.download-box {
				position: absolute;
				left:0rem;
				bottom: 0rem;
				width: 100%;
				height: 2rem;
				border-radius: 0.325rem 0.325rem 0rem 0rem;
				background-color: #FFFFFF;
			}
			
			.download-box-land {
				position: absolute;
				left:0rem;
				bottom: 0rem;
				width: 2rem;
				height: 100%;
				border-radius: 0rem 0.325rem 0.325rem 0rem;
				background-color: #FFFFFF;
			}
			
			.rotate90{
				-webkit-transform: rotate(90deg);
				-moz-transform: rotate(90deg);
				-o-transform: rotate(90deg);
				-ms-transform: rotate(90deg);
				transform: rotate(90deg);
				
				left:-40%;
				top: 40%;
				width: 100%;
				height: 2rem;
			}
			
			.download-content{
				float: left;
				margin-left: 0.5rem;
				margin-top: 0.4rem;
			}
			
			.kaixin-icon {
				width: 1.2rem;
				height: 1.2rem;
				float: left;
			}
			
			.download-text-div{
				float: left;
				margin-left: 0.3125rem;
				margin-top: 0.125rem;
			}
			
			.download-text-name{
				font-size: 0.4rem;
				color: #31373F;
			}
			
			.download-text-desc{
				font-size: 0.3rem;
				color: #999999;
				margin-top: 0.25rem;
			}
			
			.download-btn {
				float: right;
				margin-right: 0.875rem;
				margin-top: 0.5rem;
				background-image: url(img/download.png);
				font-size: 0.36rem;
				color: white;
				width: 2.5rem;
				height: 0.8rem;
				background-size: 2.5rem 0.8rem;
				text-align: center;
				line-height: 0.8rem;
				justify-content: center;
			}
			
			.close-btn{
				position: absolute;
				right: 0.2rem;
				top: -0.2rem;
			}
			
			.close-btn img{
				width: 0.4rem;
				height: 0.4rem;
			}

			.loginDialog {
				position: absolute;
				top: 0rem;
				left: 0res;
				width: 100%;
				height:100%;
				display: none;
			}
		</style>
	</head>

	<body scroll="no">
		
		<iframe id="gameFrame" name="gameFrame" frameborder="0" scrolling="no">
		
		</iframe>
		
		<img id="gameCover" style="width: 100%; height: 100%; position: absolute;top: 0px; left: 0px;"><img />
		
		

		<div class="loginDialog">
			<div class="popUps">
				<div class="popUpsBg"></div>
				<div class="popUpsLogin">
					<h1>登录</h1>
					<ul>
						<li><input id="phoneInput" type="text" placeholder="请输入您的手机号" /></li>
						<li><input id="verifyCodeInput" type="text" placeholder="短信验证码" />
						<button class="phoneCode yzmBtn" onclick="getSmsCode();">获取验证码</button>
						</li>
					</ul>
					<div class="loginButton" onclick="phoneNumLogin()">登&nbsp;&nbsp;&nbsp;&nbsp;录</div>
					<div class="tripartite">
						<div class="wechartBtn" onclick="wxLogin();">微信登录</div>
						<div class="QQBtn" onclick="qqLogin()">QQ登录</div>
					</div>
				</div>
			</div>
		</div>
		
		<div id="downloadBox" class="download-box rotate90">
			<div id="downloadContent" class="download-content">
				<img id="kaixinIcon" class="kaixin-icon" src="img/logo.png"/>
				<div id="downloadTextDiv""" class="download-text-div">
					<div id="downloadTextName" class="download-text-name">开心小游戏</div>
					<div id="downloadTextDesc" class="download-text-desc">玩小游戏，还可以赚钱哦~</div>
				</div>
			</div>
			
				<div class="download-btn" onclick="downLoad();">
					玩更多游戏
				</div>
		
			
			<div class="close-btn">
				<img src="img/close.png" onclick="closeHandler();"/>
			</div>
		</div>
		
		
		<script type="text/javascript">
			//sdk game:https://mgres.kaixin001.com.cn/xyx/pro/games/10042/41/
			//link game:http://szhong.4399.com/4399swf/upload_swf/ftp27/gamehwq/20190304/12/index.htm
			
			//本地测试
			//http://localhost?url=https://mgres.kaixin001.com.cn/xyx/pro/games/2/3/&type=sdk&gameId=2&env=0&orient=portrait&kxcode=12345&sharePath=74
			//http://localhost?url=http://szhong.4399.com/4399swf/upload_swf/ftp27/gamehwq/20190304/12/index.htm&type=link&gameId=10085&env=0&orient=portrait&kxcode=12345&sharePath=74----无效
			
			//测试环境
			//http://isstatic-test.feidou.com/frondend/share_link/index.html?url=https://mgres.kaixin001.com.cn/xyxnew/dev/open/games/2/3/&type=sdk&gameId=2&env=0&orient=portrait&kxcode=12345&sharePath=74
			//http://isstatic-test.feidou.com/frondend/share_link/index.html?url=http://szhong.4399.com/4399swf/upload_swf/ftp27/gamehwq/20190304/12/index.htm&type=link&gameId=73&env=0&orient=portrait&kxcode=12345&sharePath=74-----无效
			

			
			//正式环境
			//https://mgres.kaixin001.com.cn/xyx/static/frondend/share_link/index.html?url=https://mgres.kaixin001.com.cn/xyx/pro/games/10042/41/&type=sdk&gameId=10042&env=1&orient=portrait&kxcode=12345&sharePath=74
			//http://mgres.kaixin001.com.cn/xyx/static/frondend/share_link/index.html?url=http://szhong.4399.com/4399swf/upload_swf/ftp27/gamehwq/20190304/12/index.htm&type=link&gameId=73&env=1&orient=portrait&kxcode=12345&sharePath=74
				
			function getQueryString(name) { 
				var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i"); 
				var r = window.location.search.substr(1).match(reg); 
				if (r != null) return unescape(r[2]); 
				return null; 
			}
			
			var isSdkGame = false;
			var gameUrl;
			var gameId;
			var env;
			var gameOrient;//游戏横竖屏, portrait, landscape
			var inviteCode;//邀请码
			var thirdType;//登陆类型, 4:微信.6:facebook.9:qq
			var sharePath;//分享路径
			var protocol;//协议
			
			window.onload = function(){
				
				if(getQueryString("type") == "sdk"){
					isSdkGame = true;
				}
				
				gameUrl = decodeURI(getQueryString("url"));
				gameId = getQueryString("gameId");
				env = getQueryString("env");
				gameOrient = getQueryString("orient");
				inviteCode = getQueryString("kxcode");
				thirdType = getQueryString("thirdType");
				sharePath = getQueryString("sharePath");
				
				if(gameUrl.indexOf("https") == 0){
					protocol = "https";
				}else{
					protocol = "http";
				}
				
				try{
					document.getElementById("gameFrame").onload = function(){
						document.getElementById("gameFrame").contentWindow.alert = function(data, callback){
							console.log(data);
						}
					}
					
				}catch(e){
					console.log(e);
				}
				
				document.getElementById("downloadBox").style.display = "block";
				if(gameOrient == "landscape"){
					document.getElementById("downloadBox").style.display = "none";
					alert("当前游戏为横屏，请锁定屏幕旋转，游戏体验更佳！", function(){
						document.getElementById("downloadBox").style.display = "block";
					});
				}
				
				setOrient();
				libInit(gameId, env, inviteCode, thirdType, sharePath, protocol);
			}
			
			function gotoGame(){
				if(isSdkGame){
					var tempUrl = gameUrl+"?type=link&gameId="+gameId+"&env="+env;
					document.getElementById("gameFrame").src= tempUrl;
				}else{
					document.getElementById("gameFrame").src = gameUrl;
				}
			}
			
			function setOrient(){
				if(gameOrient == "landscape"){
					if(window.orient == "portrait"){
						document.getElementById("downloadBox").setAttribute('class','download-box rotate90');
					}else if(window.orient == "landscape"){
						document.getElementById("downloadBox").setAttribute('class','download-box');
					}
				}else{
					document.getElementById("downloadBox").setAttribute('class','download-box');
				}
			}
			
			function downloadHandler(){
				window.open("http://xyx.kaixin001.com/","_blank");
			}
			
			function downLoad() {
				var u = navigator.userAgent;
				var isAndroid = u.indexOf('Android') > -1 || u.indexOf('Adr') > -1; //android终端
				var isiOS = !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/); //ios终端
				if(isAndroid==true){
					shareStat(3);
					window.open("https://mgres.kaixin001.com.cn/xyx/static/downLoad/android/kaixin_xyx_h5.apk","_blank");
				}
				var ttt = setTimeout(function(){
					window.open("http://xyx.kaixin001.com/?from=h5","_self");
					clearTimeout(ttt);
				}, 2000)
				
			}
			
			function closeHandler(){
				document.getElementById("downloadBox").style = "display:none";
			}
			
			(function(){
				
				var supportOrientation = (typeof window.orientation === 'number' &&
						typeof window.onorientationchange === 'object');
			 
				var init = function(){
					var updateOrientation = function(){
						if(supportOrientation){
							orientation = window.orientation;
							switch(orientation){
								case 90:
								case -90:
									window.orient = 'landscape';
									break;
								default:
									window.orient = 'portrait';
									break;
							}
						}else{
							window.orient = (window.innerWidth > window.innerHeight) ? 'landscape' : 'portrait';
						}
						setOrient();
					};
			 
					if(supportOrientation){
						window.addEventListener('orientationchange',updateOrientation,false);
					}else{
						//监听resize事件
						window.addEventListener('resize',updateOrientation,false);
					}
			 
					updateOrientation();
				};
			 
				window.addEventListener('DOMContentLoaded',init,false);
				
				
				//window.alert = alert;
				function alert(data, callback) { //回调函数
					var alert_bg = document.createElement('div');
					alert_box = document.createElement('div'),
						alert_text = document.createElement('div'),
						alert_btn = document.createElement('div'),
						textNode = document.createTextNode(data ? data : ''),
						btnText = document.createTextNode('确 定');

					// 控制样式
					css(alert_bg, {
						'position': 'fixed',
						'top': '0',
						'left': '0',
						'right': '0',
						'bottom': '0',
						'background-color': 'rgba(0, 0, 0, 0.1)',
						'z-index': '999999999'
					});

					css(alert_box, {
						'width': '270px',
						'max-width': '90%',
						'font-size': '16px',
						'text-align': 'center',
						'background-color': '#fff',
						'border-radius': '15px',
						'position': 'absolute',
						'top': '50%',
						'left': '50%',
						'transform': 'translate(-50%, -50%)'
					});

					css(alert_text, {
						'padding': '10px 15px',
						'border-bottom': '1px solid #ddd'
					});

					css(alert_btn, {
						'padding': '10px 0',
						'color': '#007aff',
						'font-weight': '600',
						'cursor': 'pointer'
					});

					// 内部结构套入
					alert_text.appendChild(textNode);
					alert_btn.appendChild(btnText);
					alert_box.appendChild(alert_text);
					alert_box.appendChild(alert_btn);
					alert_bg.appendChild(alert_box);

					// 整体显示到页面内
					document.getElementsByTagName('body')[0].appendChild(alert_bg);

					// 确定绑定点击事件删除标签
					alert_btn.onclick = function() {
						alert_bg.parentNode.removeChild(alert_bg);
						if (typeof callback === 'function') {
							callback(); //回调
						}
					}
				}

				function css(targetObj, cssObj) {
					var str = targetObj.getAttribute("style") ? targetObj.getAttribute('style') : '';
					for (var i in cssObj) {
						str += i + ':' + cssObj[i] + ';';
					}
					targetObj.style.cssText = str;
				}
			})();
			
			$(function(){
				$(".yzmBtn").click(function(){
					var phoneNum = $("#phoneInput").val();
					if(phoneNum == ""){
						return;
					}
					invokeSettime(this);
				});
			})
			
			function invokeSettime(obj) {
				var countdown = 60;
				$(obj).addClass("disabled");
				settime(obj);
				function settime(obj) {
					if(countdown == 0) {
						$(obj).attr("disabled", false);
						$(obj).removeClass("disabled");
						$(obj).text("获取验证码");
						countdown = 60;
						return;
					} else {
						$(obj).attr("disabled", true);
						$(obj).text(countdown+'s');
						countdown--;
					}
					setTimeout(function() {
						settime(obj);
					}, 1000)
				}
			}
			
			function setLoginVisibel(value){
				if(value){
					$(".loginDialog").show();
				}else{
					$(".loginDialog").hide();
				}
			}
			
			function getSmsCode(){
				var phoneNum = $("#phoneInput").val();
				if(phoneNum == ""){
					alert("请输入手机号");
					return;
				}
				
				sendSMS(phoneNum);
			}
			
			function phoneNumLogin(){
				var phoneNum = $("#phoneInput").val();
				var verifyCode = $("#verifyCodeInput").val();
				
				if(phoneNum == ""){
					alert("请输入手机号");
					return;
				}
				
				if(verifyCode == ""){
					alert("请输入验证码");
					return;
				}
				
				cellphoneLogin(phoneNum, verifyCode);
			}
			
			function showGameCover(vis, url){
				if(vis){
					$("#gameCover").show();
					$("#gameCover")[0].setAttribute("src", url);
				}else{
					$("#gameCover").hide();
				}
				
			}
			
		</script>

	</body>

</html>